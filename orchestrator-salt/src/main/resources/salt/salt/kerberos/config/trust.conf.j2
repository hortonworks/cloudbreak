{%- set trust_realm = salt['pillar.get']('trust:realm') %}
{%- set trust_domain = salt['pillar.get']('trust:domain') %}
{%- set trust_kdc_fqdn = salt['pillar.get']('trust:kdcFqdn') %}
{%- set trust_extend_realms = salt['pillar.get']('trust:extendRealms', False) %}
{%- set sdx_domains = salt['pillar.get']('trust:sdxDomains') %}
{%- set kerberos_realm = salt['pillar.get']('kerberos:realm')|upper %}
[domain_realm]
.{{ trust_domain }} = {{ trust_realm }}
{{ trust_domain }} = {{ trust_realm }}
{% for sdx_domain in sdx_domains %}
{% if sdx_domain != trust_domain %}
.{{ sdx_domain }} = {{ trust_realm }}
{{ sdx_domain }} = {{ trust_realm }}
{% endif %}
{% endfor %}

[capaths]
{{ trust_realm }} = {
  {{ kerberos_realm }} = {{ trust_realm }}
}
{{ kerberos_realm }} = {
  {{ trust_realm }} = {{ trust_realm }}
}

{%- if trust_extend_realms == True %}
[realms]
{{ trust_realm }} = {
  kdc = {{ trust_kdc_fqdn }}
  admin_server = {{ trust_kdc_fqdn }}
}
{%- endif %}
