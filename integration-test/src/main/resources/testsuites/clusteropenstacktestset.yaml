name: "OPENSTACK cluster tests"
parallel: tests
threadCount: 4
parameters:
  openstackCredentialName: autotesting-clusters-os
listeners:
  - com.sequenceiq.it.cloudbreak.newway.listener.FirstLastTestExecutionBehaviour
  - com.sequenceiq.it.cloudbreak.newway.listener.GatekeeperBehaviour
  - com.sequenceiq.it.cloudbreak.newway.listener.StructuredEventsReporterOnFailingCluster
tests:
  - name: "openstack HDP315 base image datascience gatekeeper"
    preserveOrder: true
    parameters:
      clusterName: os-base-datasci
      provider: openstack
      blueprintName: "HDP 3.1.5 - Data Science: Apache Spark 2, Apache Zeppelin"
      instancegroupName: worker
      isGatekeeper: true
    classes:
      - name: com.sequenceiq.it.cloudbreak.ClusterTests
        includedMethods:
          - testCreateNewRegularCluster
          - testScaleCluster
          - testStopCluster
          - testStartCluster
          - testTerminateCluster
  - name: "openstack HDP315 cluster with knox gateway"
    preserveOrder: true
    parameters:
      clusterName: os-base-datasci-knox-gw
      provider: openstack
      blueprintName: "HDP 3.1.5 - Data Science: Apache Spark 2, Apache Zeppelin"
      instancegroupName: worker
      isGatekeeper: true
    classes:
      - name: com.sequenceiq.it.cloudbreak.ClusterTests
        includedMethods:
          - testCreateNewClusterWithKnox
          - testScaleCluster
          - testStopCluster
          - testStartCluster
          - testTerminateCluster
  - name: "openstack HDP315 base image EDW-Analytics"
    preserveOrder: true
    parameters:
      clusterName: os-base-edwan
      provider: openstack
      blueprintName: "HDP 3.1.5 - EDW-Analytics: Apache Hive 2 LLAP, Apache Zeppelin"
      workerInstanceCount: 3
      instancegroupName: worker
    classes:
      - name: com.sequenceiq.it.cloudbreak.ClusterTests
        includedMethods:
          - testCreateNewRegularCluster
          - testScaleCluster
          - testStopCluster
          - testStartCluster
          - testTerminateCluster
  - name: "openstack base hdf flow magamenet"
    preserveOrder: true
    parameters:
      clusterName: os-base-flowmgmt
      provider: openstack
      blueprintName: "Flow Management: Apache NiFi, Apache NiFi Registry"
      instancegroupName: NiFi
      enableKerberos: true
    classes:
      - name: com.sequenceiq.it.cloudbreak.ClusterTests
        includedMethods:
          - testCreateNewHdfCluster
          - testStopCluster
          - testStartCluster
          - testTerminateCluster
